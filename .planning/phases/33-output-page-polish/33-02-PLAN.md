---
phase: 33-output-page-polish
plan: 02
type: execute
wave: 2
depends_on: ["33-01"]
files_modified:
  - src/app/generate/page.tsx
autonomous: true
user_setup: []

must_haves:
  truths:
    - "Complete page shows PolishedBlueprintView instead of StrategicBlueprintDisplay"
    - "Header shows success indicator, metadata stats, and action buttons"
    - "Share button creates shareable link with copy functionality"
    - "Export PDF button works with polished layout"
    - "New Blueprint and Back to Review buttons navigate correctly"
    - "No markdown/document editor visible on complete page"
  artifacts:
    - path: "src/app/generate/page.tsx"
      provides: "Updated complete state with PolishedBlueprintView"
      contains: "PolishedBlueprintView"
  key_links:
    - from: "src/app/generate/page.tsx"
      to: "src/components/strategic-blueprint/polished-blueprint-view.tsx"
      via: "import and render"
      pattern: "import.*PolishedBlueprintView"
    - from: "src/app/generate/page.tsx"
      to: "/api/blueprints"
      via: "fetch for share"
      pattern: "fetch.*api/blueprints"
---

<objective>
Integrate PolishedBlueprintView into the complete page state, replacing StrategicBlueprintDisplay. Wire up Share, Export PDF, New Blueprint, and Back to Review actions with SaaSLaunch styling.

Purpose: Complete the output page polish by replacing the markdown document editor with the card-based layout. This addresses OUT-03 through OUT-07.

Output: Updated /generate page with polished complete state UI.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/33-output-page-polish/33-01-SUMMARY.md
@docs/SAASLAUNCH-DESIGN-LANGUAGE.md

# Reference current implementation
@src/app/generate/page.tsx
@src/components/strategic-blueprint/blueprint-viewer.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Replace StrategicBlueprintDisplay with PolishedBlueprintView</name>
  <files>src/app/generate/page.tsx</files>
  <action>
Update the complete state section in page.tsx to use the new component.

**Changes to import section:**
- Add: `import { PolishedBlueprintView } from "@/components/strategic-blueprint/polished-blueprint-view";`
- Keep StrategicBlueprintDisplay import (may be used elsewhere or remove if not)

**Changes to complete state render (around line 1080-1090):**

Replace:
```tsx
<StrategicBlueprintDisplay strategicBlueprint={strategicBlueprint} />
```

With:
```tsx
<PolishedBlueprintView strategicBlueprint={strategicBlueprint} />
```

**Key consideration:**
- The existing header (GradientBorder with success indicator, stats, and buttons) remains as-is
- Only the blueprint display below the header changes
- The header already has proper SaaSLaunch styling from v2.0

**Verify existing functionality preserved:**
- Share button and shareUrl state
- Export PDF button (currently in header - may need to move/adapt)
- Regenerate button
- Back to Review button
- New Blueprint button
  </action>
  <verify>
- `grep "PolishedBlueprintView" src/app/generate/page.tsx` returns matches
- `grep "StrategicBlueprintDisplay" src/app/generate/page.tsx` returns no matches in complete state section
  </verify>
  <done>Complete state now renders PolishedBlueprintView instead of StrategicBlueprintDisplay</done>
</task>

<task type="auto">
  <name>Task 2: Add PDF Export to Complete Page Header</name>
  <files>src/app/generate/page.tsx</files>
  <action>
Ensure PDF export functionality is available on the complete page.

**Current state analysis:**
- BlueprintViewer (used by StrategicBlueprintDisplay) has its own PDF export button
- We're replacing that, so PDF export needs to be in the header

**Implementation:**
1. Add PDF export state and handler (copy from blueprint-viewer.tsx):
   ```tsx
   const [isExporting, setIsExporting] = useState(false);
   ```

2. Add handleExportPDF callback (use existing pattern from blueprint-viewer.tsx):
   - Dynamic import of html2canvas and jspdf
   - Use PdfMarkdownContent component for rendering
   - Generate PDF with proper pagination

3. Add Export PDF button to the header action buttons section (before Share button):
   ```tsx
   <MagneticButton
     className="h-9 px-4 rounded-md text-sm font-medium flex items-center gap-2 transition-all duration-200 hover:border-[var(--accent-blue)] hover:text-[var(--accent-blue)]"
     onClick={handleExportPDF}
     disabled={isExporting}
     style={{
       border: '1px solid var(--border-default)',
       color: 'var(--text-secondary)',
       background: 'transparent',
     }}
   >
     {isExporting ? (
       <Loader2 className="h-4 w-4 animate-spin" />
     ) : (
       <Download className="h-4 w-4" />
     )}
     {isExporting ? 'Exporting...' : 'Export PDF'}
   </MagneticButton>
   ```

4. Import Download icon (already imported as RotateCcw pattern)

**Note:** The PdfMarkdownContent component already exists and handles rendering the blueprint in a PDF-friendly format.
  </action>
  <verify>
- `grep "handleExportPDF" src/app/generate/page.tsx` returns the handler
- `grep "Export PDF" src/app/generate/page.tsx` returns the button
- `grep "Download" src/app/generate/page.tsx` includes icon import
  </verify>
  <done>PDF Export button added to complete page header with full functionality</done>
</task>

<task type="auto">
  <name>Task 3: Verify and Polish Action Buttons</name>
  <files>src/app/generate/page.tsx</files>
  <action>
Ensure all action buttons follow SaaSLaunch styling and work correctly.

**Button order in header (left to right):**
1. Back to Review (secondary outline style)
2. Export PDF (secondary outline style)
3. Share (secondary outline style, shows "Shared" when done)
4. Regenerate (secondary outline style)
5. New Blueprint (primary gradient pill style)

**SaaSLaunch button styles:**

Secondary (outline):
```tsx
style={{
  border: '1px solid var(--border-default)',  // rgb(31, 31, 31)
  color: 'var(--text-secondary)',
  background: 'transparent',
  fontFamily: 'var(--font-sans), Inter, sans-serif',
}}
className="... hover:border-[var(--accent-blue)] hover:text-[var(--accent-blue)]"
```

Primary (gradient pill):
```tsx
style={{
  background: 'var(--gradient-primary)',  // linear-gradient(135deg, rgb(54, 94, 255) 0%, rgb(0, 111, 255) 100%)
  color: 'white',
  fontFamily: 'var(--font-display), "Cabinet Grotesk", sans-serif',
}}
className="... rounded-full"
```

**Verify each button:**
- Back to Review: calls handleBackToReview, navigates to review-blueprint state
- Export PDF: calls handleExportPDF, triggers PDF download
- Share: calls handleShare, creates share link, shows copy UI
- Regenerate: calls handleRegenerateBlueprint, restarts generation
- New Blueprint: calls handleStartOver, clears state and returns to onboarding

**Additional polish:**
- Ensure responsive layout with flex-wrap on mobile
- Ensure consistent gap spacing (gap-3)
- Keep existing icons (ArrowLeft, Download, Share2, RotateCcw)
  </action>
  <verify>
- Visual inspection: All 5 buttons present in header
- `grep "handleBackToReview\|handleExportPDF\|handleShare\|handleRegenerateBlueprint\|handleStartOver" src/app/generate/page.tsx` shows all handlers exist
- `grep "var(--gradient-primary)" src/app/generate/page.tsx` shows primary button styling
  </verify>
  <done>All action buttons styled consistently with SaaSLaunch design and functioning correctly</done>
</task>

</tasks>

<verification>
1. TypeScript compilation passes: `npm run build`
2. Complete page shows section cards instead of markdown editor
3. All 5 action buttons visible and styled correctly
4. Share button creates link and shows copy UI
5. Export PDF button generates PDF download
6. Navigation buttons work (Back to Review, New Blueprint)
7. Regenerate restarts blueprint generation

**Manual verification flow:**
1. Generate a blueprint
2. Complete review and approve
3. On complete page, verify:
   - 5 section cards displayed (not markdown)
   - Header shows success indicator
   - Stats show time, cost, sections
   - Back to Review navigates correctly
   - Export PDF downloads file
   - Share creates link with copy button
   - Regenerate restarts generation
   - New Blueprint returns to onboarding
</verification>

<success_criteria>
- Complete page displays PolishedBlueprintView with 5 section cards
- No markdown/document editor visible on complete page
- Header includes: success indicator, metadata (time, cost, sections), action buttons
- Share button generates link with copy functionality
- Export PDF generates downloadable PDF
- New Blueprint and Back to Review navigate correctly
- All styling follows SaaSLaunch design language
</success_criteria>

<output>
After completion, create `.planning/phases/33-output-page-polish/33-02-SUMMARY.md`
</output>
