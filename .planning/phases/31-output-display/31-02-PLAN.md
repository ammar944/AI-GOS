---
phase: 31-output-display
plan: 02
type: execute
---

<objective>
Refactor StrategicBlueprintDisplay to use DocumentEditor with syntax highlighting and v2.0 design.

Purpose: Transform the blueprint output display from traditional card layout to premium document editor aesthetic.
Output: Redesigned StrategicBlueprintDisplay using DocumentEditor component with syntax highlighting.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/docs/AI-GOS-DESIGN-SYSTEM.md
@.planning/phases/31-output-display/31-01-SUMMARY.md

**Prior plan deliverables:**
- DocumentEditor component with WindowChrome, LineNumbers, StreamingCursor

**Relevant source files:**
@src/components/strategic-blueprint/strategic-blueprint-display.tsx
@src/components/editor/document-editor.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create syntax highlighting utility</name>
  <files>src/lib/syntax.ts</files>
  <action>
Create syntax highlighting utility for blueprint content:

1. Create src/lib/syntax.ts with highlightLine function:
   - Section headers (ALL CAPS) → { color: 'var(--text-primary)', fontWeight: 700, fontSize: 14 }
   - Dividers (═ or ─) → { color: 'var(--text-muted)' }
   - Bullet points (• or □) → { color: 'var(--text-secondary)' }
   - Numbered items (^\d+\.) → highlight number with var(--accent-blue)
   - Values with % or $ → { color: 'var(--success)' }
   - Default → { color: 'var(--text-tertiary)' }

2. Export highlightLine and LineStyle type

3. Function signature:
   ```typescript
   export function highlightLine(line: string): React.CSSProperties
   ```

Reference design system "Syntax Highlighting" section.
  </action>
  <verify>
- highlightLine returns correct styles for each line type
- TypeScript types are exported
- No compilation errors
  </verify>
  <done>
Syntax highlighting utility correctly identifies and styles different line types per design system spec.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create BlueprintViewer component</name>
  <files>src/components/strategic-blueprint/blueprint-viewer.tsx</files>
  <action>
Create BlueprintViewer component that formats blueprint data for DocumentEditor:

1. Create src/components/strategic-blueprint/blueprint-viewer.tsx:
   - Props: strategicBlueprint: StrategicBlueprintOutput, isStreaming?: boolean
   - Converts structured blueprint data to formatted text lines

2. Format each section as text blocks:
   - Section header: "═══════════════════════════════════════"
   - Section title: "SECTION 1: INDUSTRY & MARKET OVERVIEW"
   - Subsection headers with "───────────────────────"
   - Bullet points with "•" prefix
   - Numbered lists with "1." prefix
   - Key-value pairs aligned

3. Use DocumentEditor component:
   - Pass formatted content string
   - Apply highlightLine to each line for styling
   - filename="strategic-blueprint.md"

4. Keep PDF export functionality (existing handleExportPDF logic)

5. Header section above DocumentEditor:
   - Same metadata display (Generated date, cost, confidence)
   - Export PDF button
   - Use v2.0 styling (var(--bg-elevated), var(--text-secondary), etc.)
  </action>
  <verify>
- BlueprintViewer renders blueprint data in formatted text
- Section headers appear with proper styling
- DocumentEditor displays with line numbers
- Export PDF still functions
  </verify>
  <done>
BlueprintViewer component converts blueprint data to formatted text and displays in DocumentEditor with syntax highlighting.
  </done>
</task>

<task type="auto">
  <name>Task 3: Update StrategicBlueprintDisplay and integrate</name>
  <files>src/components/strategic-blueprint/strategic-blueprint-display.tsx, src/app/generate/page.tsx</files>
  <action>
Refactor StrategicBlueprintDisplay to use BlueprintViewer:

1. Update strategic-blueprint-display.tsx:
   - Replace entire existing implementation with BlueprintViewer
   - Keep the same props interface for backward compatibility
   - Export StrategicBlueprintDisplay that wraps BlueprintViewer

   Alternative approach if full refactor is too disruptive:
   - Add new "editor" view mode alongside existing card view
   - Toggle between views with a button

2. Update generate/page.tsx "complete" state:
   - Use updated StrategicBlueprintDisplay
   - Apply v2.0 success banner styling (already partially done)
   - Ensure GradientBorder wrapper on main content

3. Verify integration:
   - Blueprint displays correctly in document editor format
   - All 5 sections render with proper formatting
   - PDF export continues to work
   - No breaking changes to existing functionality
  </action>
  <verify>
- npm run build succeeds
- /generate page complete state shows DocumentEditor view
- All blueprint sections render correctly
- PDF export works
- No TypeScript errors
  </verify>
  <done>
StrategicBlueprintDisplay updated to use DocumentEditor aesthetic. Complete flow from generation to output display uses v2.0 design language.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Blueprint output display with DocumentEditor aesthetic, traffic lights, line numbers, and syntax highlighting</what-built>
  <how-to-verify>
    1. Run: npm run dev
    2. Complete onboarding flow (use Auto-fill with Sample Data for speed)
    3. Wait for blueprint generation to complete
    4. On the complete state, verify:
       - Document editor window appears with traffic lights (red/yellow/green)
       - Line numbers show in left column
       - Blueprint content displays with syntax highlighting
       - Section headers are bold/white
       - Bullet points and values have appropriate colors
       - Export PDF button works
    5. Check mobile responsiveness (resize browser)
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] `npm run lint` passes
- [ ] Blueprint displays in DocumentEditor format
- [ ] Syntax highlighting works on all line types
- [ ] PDF export continues to function
- [ ] Mobile responsive layout works
</verification>

<success_criteria>
- BlueprintViewer component implemented with text formatting
- Syntax highlighting utility working correctly
- StrategicBlueprintDisplay uses v2.0 design language
- DocumentEditor aesthetic applied to blueprint output
- All existing functionality preserved
- Phase 31 complete
</success_criteria>

<output>
After completion, create `.planning/phases/31-output-display/31-02-SUMMARY.md`
</output>
