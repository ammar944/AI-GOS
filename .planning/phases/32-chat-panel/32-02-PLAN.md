---
phase: 32-chat-panel
plan: 2
type: execute
---

<objective>
Complete chat panel with typing indicator, suggestion pills, and full BlueprintChat integration.

Purpose: Finalize the v2.0 chat experience with animated feedback and quick actions.
Output: Fully integrated chat panel replacing the old UI with premium v2.0 aesthetic.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/docs/AI-GOS-DESIGN-SYSTEM.md

**Prior plan output:**
@.planning/phases/32-chat-panel/32-01-SUMMARY.md

**Components from Plan 1:**
@src/components/chat/chat-panel.tsx
@src/components/chat/message-bubble.tsx
@src/components/chat/index.ts

**Existing BlueprintChat to refactor:**
@src/components/chat/blueprint-chat.tsx

**Design spec for typing indicator:**
```jsx
<div style={{ display: 'flex', gap: 6 }}>
  {[0, 1, 2].map(i => (
    <motion.div
      key={i}
      animate={{
        y: [0, -6, 0],
        opacity: [0.4, 1, 0.4],
      }}
      transition={{
        duration: 0.8,
        repeat: Infinity,
        delay: i * 0.15,
      }}
      style={{
        width: 8,
        height: 8,
        borderRadius: '50%',
        background: 'linear-gradient(135deg, #3b82f6, #8b5cf6)',
      }}
    />
  ))}
</div>
```

**Design spec for suggestion pills:**
- Quick actions: "Adjust budget", "Add channel", "Explain competitors"
- Pill styling: `padding: 8px 14px`, `borderRadius: 9999px`, subtle border
- Hover: background opacity increase
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create TypingIndicator component</name>
  <files>src/components/chat/typing-indicator.tsx</files>
  <action>
Create TypingIndicator component per design spec:
1. Three dots with staggered bounce animation
2. Gradient background: `linear-gradient(135deg, #3b82f6, #8b5cf6)`
3. Animation:
   - y: [0, -6, 0] with duration 0.8s
   - opacity: [0.4, 1, 0.4]
   - repeat: Infinity
   - delay: i * 0.15 for each dot
4. Container: flex with gap-1.5 (6px)
5. Each dot: w-2 h-2 rounded-full

Wrap in a message bubble container styled like assistant messages for consistent positioning.
  </action>
  <verify>npm run build passes</verify>
  <done>TypingIndicator renders with smooth gradient dot animation</done>
</task>

<task type="auto">
  <name>Task 2: Create QuickSuggestions component</name>
  <files>src/components/chat/quick-suggestions.tsx</files>
  <action>
Create QuickSuggestions pill row:
1. Fixed suggestions array:
   - "Adjust budget targets"
   - "Add a channel"
   - "Explain competitors"
   - "Summarize insights"
2. Pill styling:
   - padding: 8px 14px
   - background: rgba(255,255,255,0.05)
   - border: 1px solid rgba(255,255,255,0.08)
   - borderRadius: 9999px (full pill)
   - fontSize: 13px
   - color: #a0a0a0
3. Hover state:
   - background: rgba(255,255,255,0.10)
   - color: #ffffff
   - transition: 200ms
4. Horizontal scroll on overflow with hidden scrollbar
5. Props:
```typescript
interface QuickSuggestionsProps {
  onSelect: (suggestion: string) => void;
  disabled?: boolean;
}
```

Use motion.button for each pill with whileHover and whileTap.
  </action>
  <verify>npm run build passes</verify>
  <done>QuickSuggestions renders horizontally scrollable pills</done>
</task>

<task type="auto">
  <name>Task 3: Refactor BlueprintChat to use new components</name>
  <files>src/components/chat/blueprint-chat.tsx</files>
  <action>
Refactor BlueprintChat to integrate Plan 1 and Plan 2 components:

1. Replace collapsed button with floating chat trigger:
   - Use MagneticButton with sparkles icon
   - Position: fixed bottom-6 left-6
   - Gradient background matching primary buttons
   - Pulse animation when closed

2. Replace inline chat container with ChatPanel:
   - Pass isOpen, onClose, children props
   - ChatPanel handles slide animation and backdrop

3. Replace ChatMessage with MessageBubble:
   - Map existing message props to new interface
   - Add stagger delays based on message index

4. Replace loading dots with TypingIndicator:
   - Show when isLoading or isStreaming

5. Add QuickSuggestions above input:
   - Show when messages.length === 0 (empty state)
   - onSelect fills input and submits

6. Style input area:
   - Background: rgba(255,255,255,0.03)
   - Border: 1px solid rgba(255,255,255,0.08)
   - Focus: border-color rgba(59,130,246,0.5)
   - Send button: MagneticButton with gradient

7. Keep all existing logic:
   - handleSubmit
   - processStream
   - handleConfirmAll/CancelAll
   - pendingEdits UI

8. Update pending edits UI to match v2.0:
   - Use GradientBorder wrapper
   - Amber accent for edit proposals
  </action>
  <verify>npm run build passes, no TypeScript errors</verify>
  <done>BlueprintChat fully uses v2.0 components with preserved functionality</done>
</task>

<task type="auto">
  <name>Task 4: Update barrel exports</name>
  <files>src/components/chat/index.ts</files>
  <action>
Update barrel export to include new components:
```typescript
export { ChatPanel } from './chat-panel';
export { MessageBubble } from './message-bubble';
export { TypingIndicator } from './typing-indicator';
export { QuickSuggestions } from './quick-suggestions';
export { BlueprintChat } from './blueprint-chat';
```
  </action>
  <verify>npm run build passes</verify>
  <done>All chat components exported from index</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete v2.0 chat panel with animations, typing indicator, and suggestions</what-built>
  <how-to-verify>
    1. Run: npm run dev
    2. Navigate to /generate
    3. Complete the wizard to generate a blueprint (or use existing)
    4. On the complete page, click the chat button (bottom-left)
    5. Verify:
       - Panel slides in from right with backdrop
       - Empty state shows quick suggestion pills
       - Click a suggestion - it submits automatically
       - Typing indicator shows gradient bouncing dots during loading
       - User messages have blue gradient background
       - AI messages have subtle dark background
       - Input area matches v2.0 styling
    6. Test edit flow:
       - Type "Change the budget to $50,000"
       - Verify pending edit UI has amber styling
    7. Close panel and verify slide-out animation
  </how-to-verify>
  <resume-signal>Type "approved" if chat works correctly, or describe issues</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] `npm run lint` passes
- [ ] Chat panel slides in/out with animation
- [ ] Typing indicator has gradient dots
- [ ] Quick suggestions appear in empty state
- [ ] All existing chat functionality preserved (Q&A, edits, streaming)
</verification>

<success_criteria>
- Complete chat UI with v2.0 design language
- Smooth animations throughout (slide, typing, hover)
- All existing functionality works (streaming, edits, confirmations)
- Phase 32 complete
</success_criteria>

<output>
After completion, create `.planning/phases/32-chat-panel/32-02-SUMMARY.md`

Phase 32 complete - v2.0 Design Refresh milestone finished.
</output>
