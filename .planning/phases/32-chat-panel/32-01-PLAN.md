---
phase: 32-chat-panel
plan: 1
type: execute
---

<objective>
Build slide panel container and message bubble components with v2.0 design language.

Purpose: Transform the existing chat UI from shadcn defaults to premium v2.0 aesthetic with Framer Motion animations.
Output: ChatPanel component with slide-in animation, backdrop, and styled MessageBubble components.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/docs/AI-GOS-DESIGN-SYSTEM.md

**v2.0 Design Patterns (established in Phases 27-31):**
@src/components/ui/gradient-border.tsx
@src/components/ui/magnetic-button.tsx
@src/lib/motion.ts

**Existing chat implementation to transform:**
@src/components/chat/blueprint-chat.tsx
@src/components/chat/chat-message.tsx

**Prior phase decisions:**
- Phase 28: HTMLMotionProps for motion components, useSpring for physics-based animations
- Phase 31: GradientBorder for premium containers, inline styles for v2.0 aesthetic

**Design spec for Chat Panel:**
```
┌─────────────────────────────────────┐
│  ✦ AI Editor                    ×  │  ← Header with icon + close
│  Refine your blueprint...          │
├─────────────────────────────────────┤
│                                     │
│  AI message bubble                  │  ← Left-aligned, subtle bg
│                                     │
│              User message bubble    │  ← Right-aligned, gradient bg
│                                     │
├─────────────────────────────────────┤
│  [input] [send]                     │
└─────────────────────────────────────┘
```

**Message bubble specs from design system:**
- AI message: `padding: 14px 18px`, `background: rgba(255,255,255,0.05)`, `border: 1px solid rgba(255,255,255,0.08)`, `borderRadius: 16px`, `borderBottomLeftRadius: 4px`
- User message: `padding: 14px 18px`, `background: linear-gradient(135deg, #3b82f6, #2563eb)`, `borderRadius: 16px`, `borderBottomRightRadius: 4px`
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create ChatPanel slide container</name>
  <files>src/components/chat/chat-panel.tsx</files>
  <action>
Create new ChatPanel component with:
1. AnimatePresence wrapper for mount/unmount animations
2. Backdrop: fixed overlay with onClick to close, `bg-black/50` with blur
3. Panel: slides in from right with Framer Motion
   - Width: 400px (desktop), full width (mobile <640px)
   - Height: 100vh
   - Background: `var(--bg-elevated)` (#0a0a0a)
   - Border: 1px solid `rgba(255,255,255,0.06)`
   - Animation: x: 400 → 0 with spring smooth preset
4. Header: gradient background matching design system
   - ✦ icon (sparkles) + "AI Editor" title
   - Subtitle: "Refine your blueprint..."
   - Close button (X icon) with MagneticButton wrapper
5. Scrollable message area with `flex-1 overflow-y-auto`
6. Footer area for input (placeholder for now)

Props interface:
```typescript
interface ChatPanelProps {
  isOpen: boolean;
  onClose: () => void;
  children: React.ReactNode;
}
```

Use springs from @/lib/motion for animations.
Use CSS variables for colors with fallbacks.
  </action>
  <verify>npm run build passes, no TypeScript errors</verify>
  <done>ChatPanel component renders with slide animation and proper v2.0 styling</done>
</task>

<task type="auto">
  <name>Task 2: Create MessageBubble component</name>
  <files>src/components/chat/message-bubble.tsx</files>
  <action>
Create new MessageBubble component replacing ChatMessage with v2.0 styling:

1. Two variants: 'user' | 'assistant'
2. User message styling:
   - Right-aligned (ml-auto)
   - Gradient background: `linear-gradient(135deg, #3b82f6, #2563eb)`
   - Border radius: 16px with bottomRight 4px
   - Max width: 85%
   - White text
3. Assistant message styling:
   - Left-aligned
   - Background: `rgba(255,255,255,0.05)`
   - Border: 1px solid `rgba(255,255,255,0.08)`
   - Border radius: 16px with bottomLeft 4px
   - Max width: 85%
   - Secondary text color (`#a0a0a0`)
4. Edit proposal variant:
   - Border: 1px solid `rgba(245,158,11,0.3)` (amber)
   - Icon: Pencil instead of Bot
5. Explanation variant:
   - Border: 1px solid `rgba(59,130,246,0.3)` (blue)
   - Icon: Lightbulb
6. Fade-up entrance animation with stagger delay prop

Props interface:
```typescript
interface MessageBubbleProps {
  role: 'user' | 'assistant';
  content: string;
  isEditProposal?: boolean;
  isExplanation?: boolean;
  confidence?: 'high' | 'medium' | 'low';
  isLoading?: boolean;
  delay?: number; // stagger animation delay
}
```

Keep renderContent logic from existing chat-message.tsx for edit proposal formatting.
  </action>
  <verify>npm run build passes, no TypeScript errors</verify>
  <done>MessageBubble component with user/assistant variants and proper v2.0 styling</done>
</task>

<task type="auto">
  <name>Task 3: Create chat barrel export</name>
  <files>src/components/chat/index.ts</files>
  <action>
Create barrel export file for chat components:
```typescript
export { ChatPanel } from './chat-panel';
export { MessageBubble } from './message-bubble';
export { BlueprintChat } from './blueprint-chat';
```

This establishes the module structure for Phase 32 Plan 2 integration.
  </action>
  <verify>npm run build passes</verify>
  <done>Chat module exports all components</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>ChatPanel slide container and MessageBubble components with v2.0 styling</what-built>
  <how-to-verify>
    1. Run: npm run dev
    2. Navigate to /generate with a completed blueprint
    3. Open browser console and run:
       ```javascript
       // Temporarily render ChatPanel for visual check
       import('@/components/chat').then(m => console.log('Chat components loaded:', Object.keys(m)))
       ```
    4. Verify in component source:
       - ChatPanel has slide animation code with AnimatePresence
       - MessageBubble has gradient styling for user messages
       - Both use CSS variables with fallbacks
  </how-to-verify>
  <resume-signal>Type "approved" if components look correct, or describe issues</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] `npm run lint` passes
- [ ] ChatPanel.tsx has AnimatePresence and slide animation
- [ ] MessageBubble.tsx has gradient user styling and subtle AI styling
- [ ] Barrel export works: `import { ChatPanel, MessageBubble } from '@/components/chat'`
</verification>

<success_criteria>
- ChatPanel component with slide-in animation and backdrop
- MessageBubble component with user/assistant variants
- Both components follow v2.0 design patterns
- No TypeScript or lint errors
</success_criteria>

<output>
After completion, create `.planning/phases/32-chat-panel/32-01-SUMMARY.md`
</output>
