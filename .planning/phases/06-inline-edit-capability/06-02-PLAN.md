---
phase: 06-inline-edit-capability
plan: 02
type: execute
---

<objective>
Integrate EditableText/EditableList into section content renderers and wire edit state management.

Purpose: Enable users to edit strategic research content inline during review.
Output: Updated section-content.tsx with edit capability, review.tsx with edit state tracking.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-inline-edit-capability/06-01-SUMMARY.md

**Codebase constraints:**
- React 19 with "use client" directive
- State lifted to parent components (review.tsx holds edits)
- Callback props for edit handlers

**Prior decisions affecting this phase:**
- Phase 05-02: Multiple sections can expand simultaneously (allows comparing while editing)
- Phase 05-02: Resume goes to review-blueprint (edits happen during review phase)
- Phase 05-01: Helpers like safeRender/safeArray in section-content.tsx

**Relevant source files:**
@src/components/strategic-research/section-content.tsx
@src/components/strategic-research/section-card.tsx
@src/components/strategic-research/review.tsx
@src/components/strategic-research/editable/index.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add edit mode to section content renderers</name>
  <files>src/components/strategic-research/section-content.tsx</files>
  <action>
Update SectionContentRenderer and section content components to support editing:

1. **Add isEditing prop to SectionContentRenderer:**
   ```typescript
   interface SectionContentRendererProps {
     sectionKey: StrategicBlueprintSection;
     data: unknown;
     isEditing?: boolean;
     onFieldChange?: (fieldPath: string, newValue: unknown) => void;
   }
   ```

2. **Update each section content component** (IndustryMarketContent, ICPAnalysisContent, etc.):
   - Add isEditing and onFieldChange props
   - When isEditing=true, render EditableText/EditableList for editable fields
   - When isEditing=false, render plain text as before (existing behavior)

3. **Identify editable fields per section:**

   **IndustryMarketContent:**
   - categorySnapshot.category (text)
   - marketDynamics.demandDrivers (list)
   - marketDynamics.buyingTriggers (list)
   - marketDynamics.barriersToPurchase (list)
   - painPoints.primary (list)
   - painPoints.secondary (list)
   - messagingOpportunities.summaryRecommendations (list)

   **ICPAnalysisContent:**
   - finalVerdict.reasoning (text, multiline)
   - painSolutionFit.primaryPain (text)
   - painSolutionFit.offerComponentSolvingIt (text)
   - finalVerdict.recommendations (list)

   **OfferAnalysisContent:**
   - recommendation.reasoning (text, multiline)
   - recommendation.actionItems (list)

   **CompetitorAnalysisContent:**
   - competitors[].name, positioning, offer, price (text each)
   - competitors[].strengths (list)
   - competitors[].weaknesses (list)
   - gapsAndOpportunities.messagingOpportunities (list)
   - gapsAndOpportunities.creativeOpportunities (list)
   - gapsAndOpportunities.funnelOpportunities (list)

   **CrossAnalysisContent:**
   - recommendedPositioning (text, multiline)
   - primaryMessagingAngles (list)
   - criticalSuccessFactors (list)
   - potentialBlockers (list)
   - nextSteps (list)

4. **Field path format:** Use dot notation like "categorySnapshot.category" or "competitors.0.name" for arrays.

5. **Keep non-editable fields as-is:** Boolean checks (BoolCheck), scores (ScoreDisplay), badges, and status indicators remain read-only.

Do NOT change behavior when isEditing=false - preserve existing read-only rendering exactly.
  </action>
  <verify>npm run build succeeds, no TypeScript errors</verify>
  <done>Section renderers support isEditing mode with EditableText/EditableList for text/list fields</done>
</task>

<task type="auto">
  <name>Task 2: Wire edit state in Review component</name>
  <files>src/components/strategic-research/review.tsx, src/components/strategic-research/section-card.tsx</files>
  <action>
Add edit state management to StrategicResearchReview:

1. **Add state for pending edits:**
   ```typescript
   // Store edits as a nested object matching the blueprint structure
   const [pendingEdits, setPendingEdits] = useState<Record<string, Record<string, unknown>>>({});
   ```

2. **Add edit mode toggle per section:**
   - Add "Edit" button to SectionCard header (next to expand/collapse)
   - Track which section is in edit mode: `editingSection: StrategicBlueprintSection | null`
   - Only one section editable at a time (keeps UX focused)

3. **Update SectionCard props:**
   - isEditing: boolean
   - onToggleEdit: () => void
   - onFieldChange: (fieldPath: string, newValue: unknown) => void

4. **Update SectionCard UI:**
   - Add Edit/Done button in header (Pencil icon for Edit, Check for Done)
   - When editing, pass isEditing=true to SectionContentRenderer
   - When editing, show subtle edit mode indicator (e.g., blue border)

5. **Implement handleFieldChange in review.tsx:**
   ```typescript
   const handleFieldChange = (sectionKey: string, fieldPath: string, newValue: unknown) => {
     setPendingEdits(prev => ({
       ...prev,
       [sectionKey]: {
         ...(prev[sectionKey] || {}),
         [fieldPath]: newValue
       }
     }));
   };
   ```

6. **Merge edits for display:**
   - Create getMergedSectionData(sectionKey) that deep-merges original data with pending edits
   - Pass merged data to SectionCard

7. **Persist edits to parent:**
   - Update StrategicResearchReviewProps to include: onEdit?: (sectionKey: string, fieldPath: string, newValue: unknown) => void
   - Call onEdit when changes are made (allows parent to store edits)

8. **Visual indicators:**
   - Show "Edited" badge on SectionCard header if section has pending edits
   - Different color than "Reviewed" badge (e.g., blue vs green)
  </action>
  <verify>npm run build succeeds, no TypeScript errors</verify>
  <done>Review component tracks edits, SectionCard has edit mode toggle, edits persist to parent</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Inline editing functionality for strategic research sections</what-built>
  <how-to-verify>
    1. Run: npm run dev
    2. Start a generation at /generate or navigate to review-blueprint state with existing data
    3. Expand a section (e.g., Industry & Market Overview)
    4. Click "Edit" button in section header
    5. Verify: Text fields show hover state, click to edit
    6. Click on a text field (e.g., Category), verify input appears
    7. Type a new value, press Enter or click checkmark
    8. Verify: Value updates, "Edited" badge appears on section
    9. Test list editing: Click a list item, edit, save
    10. Test add item: Click "+" button, type new item
    11. Test remove item: Hover item, click "Ã—" button
    12. Click "Done" to exit edit mode
    13. Verify: Edits persist, section shows modified data
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] Edit mode toggles correctly per section
- [ ] EditableText works for text fields
- [ ] EditableList works for array fields
- [ ] Edits persist and display correctly
- [ ] Non-editable fields remain read-only
</verification>

<success_criteria>
- Inline editing works for all identified text/list fields
- Edit state tracked in Review component
- Visual feedback for edit mode and edited sections
- Phase 6 complete - inline edit capability working
</success_criteria>

<output>
After completion, create `.planning/phases/06-inline-edit-capability/06-02-SUMMARY.md`:

# Phase 6 Plan 2: Section Integration & Edit State Summary

**[Substantive one-liner]**

## Performance
- Duration: ~X min
- Tasks: 3 (2 auto + 1 checkpoint)
- Files modified: X

## Accomplishments
- [Key outcomes]

## Files Created/Modified
- `path/to/file` - Description

## Decisions Made
[Key decisions or "None"]

## Deviations from Plan
[Any deviations or "None"]

## Issues Encountered
[Problems and resolutions or "None"]

## Next Phase Readiness
- Phase 6 complete
- Ready for Phase 7 (Approval Flow)
- Edit state ready to feed into approval workflow
</output>
