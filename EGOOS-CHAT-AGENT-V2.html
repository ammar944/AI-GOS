<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Egoos Agent — V2 Figma AI Layout</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,400;0,9..40,500;0,9..40,600;0,9..40,700;1,9..40,400&family=JetBrains+Mono:wght@400;500&family=Instrument+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
/* ═══════════════════════════════════════════════════════
   EGOOS AGENT V2 — FIGMA AI INSPIRED LAYOUT
   Narrow chat | Full-width blueprint document
   ═══════════════════════════════════════════════════════ */

:root {
  /* Core surfaces */
  --bg-base: #07090e;
  --bg-elevated: #0a0d14;
  --bg-surface: #0b0d12;
  --bg-chat: #090b10;
  --bg-hover: #13161d;
  --bg-active: #191c24;
  --bg-card: #0d0f15;
  --bg-input: #0e1017;

  /* Text hierarchy */
  --text-primary: #f4f4f2;
  --text-secondary: #b4b8c1;
  --text-tertiary: #5c616c;
  --text-quaternary: #2e323c;
  --text-link: #6b8aff;

  /* Borders */
  --border-subtle: rgba(255,255,255,0.05);
  --border-default: rgba(255,255,255,0.08);
  --border-hover: rgba(255,255,255,0.12);
  --border-focus: #4d6fff;

  /* Accents */
  --accent-blue: #4d6fff;
  --accent-blue-dim: rgba(77,111,255,0.12);
  --accent-cyan: #3ee8d6;
  --accent-cyan-dim: rgba(62,232,214,0.1);
  --accent-amber: #f0a030;
  --accent-amber-dim: rgba(240,160,48,0.1);
  --accent-green: #34d27b;
  --accent-green-dim: rgba(52,210,123,0.1);
  --accent-red: #f05050;
  --accent-purple: #9b7dff;
  --accent-purple-dim: rgba(155,125,255,0.1);

  /* Shadows */
  --shadow-sm: 0 1px 2px rgba(0,0,0,0.5);
  --shadow-md: 0 4px 12px rgba(0,0,0,0.4);
  --shadow-glow: 0 0 24px rgba(77,111,255,0.12);

  /* Layout */
  --chat-width: 340px;
  --header-height: 52px;

  /* Fonts */
  --font-sans: 'DM Sans', -apple-system, BlinkMacSystemFont, sans-serif;
  --font-display: 'Instrument Sans', sans-serif;
  --font-mono: 'JetBrains Mono', 'SF Mono', monospace;
}

* { margin: 0; padding: 0; box-sizing: border-box; }
html, body { height: 100%; overflow: hidden; }

body {
  font-family: var(--font-sans);
  background: var(--bg-base);
  color: var(--text-primary);
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* ═══════════════════════════════════════════════
   APP SHELL
   ═══════════════════════════════════════════════ */

.app {
  display: flex;
  flex-direction: column;
  height: 100vh;
}

/* Header */
.header {
  height: var(--header-height);
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 16px 0 20px;
  border-bottom: 1px solid var(--border-default);
  background: var(--bg-elevated);
  flex-shrink: 0;
  z-index: 20;
}

.header-left {
  display: flex;
  align-items: center;
  gap: 14px;
}

.logo-mark {
  width: 30px; height: 30px;
  border-radius: 9px;
  background: linear-gradient(135deg, #4d6fff, #2b4dd4);
  display: flex; align-items: center; justify-content: center;
  box-shadow: 0 2px 8px rgba(77,111,255,0.25);
}

.logo-mark svg { width: 16px; height: 16px; fill: white; }

.logo-text {
  font-family: var(--font-display);
  font-weight: 700;
  font-size: 16px;
  letter-spacing: -0.03em;
  color: var(--text-primary);
}

.logo-text span {
  font-weight: 400;
  color: var(--text-tertiary);
  margin-left: 6px;
  font-size: 12px;
}

.header-nav {
  display: flex;
  align-items: center;
  gap: 4px;
  background: var(--bg-base);
  padding: 3px;
  border-radius: 10px;
  border: 1px solid var(--border-subtle);
}

.nav-item {
  padding: 5px 14px;
  border-radius: 7px;
  font-size: 12px;
  font-weight: 500;
  color: var(--text-tertiary);
  cursor: pointer;
  transition: all 0.15s;
  border: none;
  background: none;
  font-family: inherit;
  white-space: nowrap;
}

.nav-item:hover { color: var(--text-secondary); }

.nav-item.active {
  background: var(--bg-hover);
  color: var(--text-primary);
  box-shadow: var(--shadow-sm);
}

.header-actions {
  display: flex;
  align-items: center;
  gap: 8px;
}

.btn-header {
  padding: 6px 14px;
  border-radius: 8px;
  font-size: 12px;
  font-weight: 500;
  cursor: pointer;
  border: 1px solid var(--border-default);
  background: transparent;
  color: var(--text-secondary);
  font-family: inherit;
  transition: all 0.15s;
}

.btn-header:hover { border-color: var(--border-hover); color: var(--text-primary); }

.btn-header.primary {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: white;
}

.btn-header.primary:hover { background: #5a79ff; }

/* ═══════════════════════════════════════════════
   MAIN SPLIT — Chat (340px) | Blueprint (flex-1)
   ═══════════════════════════════════════════════ */

.main {
  display: flex;
  flex: 1;
  min-height: 0;
}

/* ═══════════════════════════════════════════════
   CHAT PANEL — Narrow Left Sidebar
   Inspired by Figma AI's conversational panel
   ═══════════════════════════════════════════════ */

.chat-panel {
  width: var(--chat-width);
  flex-shrink: 0;
  display: flex;
  flex-direction: column;
  background: var(--bg-chat);
  border-right: 1px solid var(--border-default);
  position: relative;
}

/* Messages area */
.messages {
  flex: 1;
  overflow-y: auto;
  padding: 20px 16px;
  display: flex;
  flex-direction: column;
  gap: 18px;
  scrollbar-width: thin;
  scrollbar-color: var(--border-default) transparent;
}

.messages::-webkit-scrollbar { width: 5px; }
.messages::-webkit-scrollbar-track { background: transparent; }
.messages::-webkit-scrollbar-thumb { background: var(--border-default); border-radius: 3px; }

/* Reasoning / Thinking block */
.reasoning-block {
  padding: 10px 12px;
  border-radius: 10px;
  background: rgba(77,111,255,0.04);
  border: 1px solid rgba(77,111,255,0.08);
  cursor: pointer;
  transition: background 0.15s;
}

.reasoning-block:hover { background: rgba(77,111,255,0.07); }

.reasoning-header {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 11.5px;
  font-weight: 500;
  color: var(--accent-blue);
}

.reasoning-header svg { width: 14px; height: 14px; opacity: 0.7; }

.reasoning-body {
  margin-top: 8px;
  font-size: 12px;
  line-height: 1.6;
  color: var(--text-secondary);
}

/* Worked with files */
.files-badge {
  display: inline-flex;
  align-items: center;
  gap: 5px;
  padding: 5px 10px;
  border-radius: 7px;
  background: var(--bg-hover);
  border: 1px solid var(--border-subtle);
  font-size: 11px;
  color: var(--text-tertiary);
  cursor: pointer;
  transition: all 0.15s;
}

.files-badge:hover { border-color: var(--border-hover); color: var(--text-secondary); }

.files-badge svg { width: 12px; height: 12px; }

/* AI message */
.msg-ai {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.msg-ai-text {
  font-size: 13px;
  line-height: 1.65;
  color: var(--text-secondary);
}

.msg-ai-text strong { color: var(--text-primary); font-weight: 600; }
.msg-ai-text code {
  font-family: var(--font-mono);
  font-size: 11.5px;
  background: var(--bg-hover);
  padding: 1px 5px;
  border-radius: 4px;
  color: var(--accent-cyan);
}

/* User message */
.msg-user {
  display: flex;
  justify-content: flex-end;
}

.msg-user-bubble {
  max-width: 88%;
  padding: 9px 13px;
  background: var(--bg-hover);
  border: 1px solid var(--border-default);
  border-radius: 14px 14px 4px 14px;
  font-size: 13px;
  line-height: 1.55;
  color: var(--text-primary);
}

/* ═══════════════════════════════════════════════
   INLINE ARTIFACT CARDS — Rendered inside chat
   ═══════════════════════════════════════════════ */

/* --- Deep Research Card --- */
.card-research {
  border: 1px solid rgba(77,111,255,0.15);
  border-radius: 11px;
  overflow: hidden;
  background: var(--bg-card);
}

.card-research-header {
  padding: 10px 12px;
  background: var(--accent-blue-dim);
  display: flex;
  align-items: center;
  justify-content: space-between;
  border-bottom: 1px solid rgba(77,111,255,0.1);
}

.card-label {
  font-family: var(--font-mono);
  font-size: 9.5px;
  font-weight: 500;
  text-transform: uppercase;
  letter-spacing: 0.08em;
}

.card-label.blue { color: var(--accent-blue); }
.card-label.amber { color: var(--accent-amber); }
.card-label.purple { color: var(--accent-purple); }
.card-label.cyan { color: var(--accent-cyan); }
.card-label.green { color: var(--accent-green); }

.card-meta {
  font-size: 10px;
  color: var(--text-tertiary);
  font-family: var(--font-mono);
}

.card-research-steps {
  padding: 10px 12px;
  display: flex;
  align-items: center;
  gap: 6px;
  border-bottom: 1px solid var(--border-subtle);
}

.step-dot {
  width: 16px; height: 16px;
  border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
  font-size: 8px;
  font-weight: 600;
}

.step-dot.done { background: var(--accent-green); color: white; }
.step-dot.active { background: var(--accent-blue); color: white; animation: pulse-step 1.5s infinite; }

@keyframes pulse-step {
  0%, 100% { box-shadow: 0 0 0 0 rgba(77,111,255,0.3); }
  50% { box-shadow: 0 0 0 4px rgba(77,111,255,0); }
}

.step-label {
  font-size: 10.5px;
  color: var(--text-tertiary);
}

.step-label.done { color: var(--accent-green); }
.step-label.active { color: var(--accent-blue); }

.step-arrow {
  font-size: 9px;
  color: var(--text-quaternary);
  margin: 0 2px;
}

.card-research-body {
  padding: 10px 12px;
}

.finding {
  padding: 7px 10px;
  background: var(--bg-hover);
  border-radius: 7px;
  margin-bottom: 6px;
  font-size: 11.5px;
  line-height: 1.5;
  color: var(--text-secondary);
}

.finding:last-child { margin-bottom: 0; }

.finding-title {
  font-weight: 600;
  color: var(--text-primary);
  font-size: 11px;
  margin-bottom: 2px;
}

.citation {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 14px; height: 14px;
  border-radius: 3px;
  background: var(--accent-blue-dim);
  color: var(--accent-blue);
  font-size: 9px;
  font-weight: 600;
  font-family: var(--font-mono);
  vertical-align: super;
  margin-left: 1px;
  cursor: pointer;
  transition: background 0.15s;
}

.citation:hover { background: rgba(77,111,255,0.25); }

.card-research-sources {
  padding: 8px 12px;
  border-top: 1px solid var(--border-subtle);
  display: flex;
  flex-wrap: wrap;
  gap: 5px;
}

.source-chip {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 3px 8px;
  border-radius: 5px;
  background: var(--bg-hover);
  font-size: 10px;
  color: var(--text-tertiary);
  border: 1px solid var(--border-subtle);
}

.source-chip img {
  width: 12px; height: 12px;
  border-radius: 2px;
}

/* --- Edit Proposal Card --- */
.card-edit {
  border: 1px solid rgba(240,160,48,0.2);
  border-radius: 11px;
  overflow: hidden;
  background: var(--bg-card);
}

.card-edit-header {
  padding: 10px 12px;
  background: var(--accent-amber-dim);
  display: flex;
  align-items: center;
  justify-content: space-between;
  border-bottom: 1px solid rgba(240,160,48,0.1);
}

.card-edit-section {
  font-family: var(--font-mono);
  font-size: 10px;
  color: var(--text-tertiary);
}

.card-edit-diff {
  padding: 10px 12px;
  font-family: var(--font-mono);
  font-size: 11px;
  line-height: 1.65;
}

.diff-remove {
  color: var(--accent-red);
  text-decoration: line-through;
  opacity: 0.7;
}

.diff-add {
  color: var(--accent-green);
  background: rgba(52,210,123,0.06);
  padding: 1px 3px;
  border-radius: 3px;
}

.card-edit-actions {
  padding: 8px 12px;
  border-top: 1px solid var(--border-subtle);
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.card-edit-actions .hint {
  font-size: 10px;
  color: var(--text-quaternary);
}

.card-edit-actions kbd {
  display: inline-block;
  padding: 1px 4px;
  border-radius: 3px;
  background: var(--bg-hover);
  border: 1px solid var(--border-subtle);
  font-family: var(--font-mono);
  font-size: 9px;
  color: var(--text-tertiary);
  margin: 0 1px;
}

.card-edit-actions .btns {
  display: flex;
  gap: 6px;
}

.btn-reject, .btn-approve {
  padding: 4px 12px;
  border-radius: 6px;
  font-size: 11px;
  font-weight: 500;
  border: none;
  cursor: pointer;
  font-family: inherit;
  transition: all 0.15s;
}

.btn-reject {
  background: rgba(240,80,80,0.1);
  color: var(--accent-red);
  border: 1px solid rgba(240,80,80,0.15);
}

.btn-reject:hover { background: rgba(240,80,80,0.18); }

.btn-approve {
  background: rgba(52,210,123,0.12);
  color: var(--accent-green);
  border: 1px solid rgba(52,210,123,0.15);
}

.btn-approve:hover { background: rgba(52,210,123,0.22); }

/* --- Score Card --- */
.card-score {
  border: 1px solid rgba(62,232,214,0.15);
  border-radius: 11px;
  overflow: hidden;
  background: var(--bg-card);
}

.card-score-header {
  padding: 10px 12px;
  background: var(--accent-cyan-dim);
  display: flex;
  align-items: center;
  justify-content: space-between;
  border-bottom: 1px solid rgba(62,232,214,0.1);
}

.score-big {
  font-family: var(--font-mono);
  font-size: 20px;
  font-weight: 500;
  color: var(--accent-cyan);
}

.card-score-bars {
  padding: 10px 12px;
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.score-row {
  display: flex;
  align-items: center;
  gap: 8px;
}

.score-label {
  font-size: 10.5px;
  color: var(--text-tertiary);
  width: 75px;
  flex-shrink: 0;
}

.score-track {
  flex: 1;
  height: 5px;
  background: var(--bg-hover);
  border-radius: 3px;
  overflow: hidden;
}

.score-fill {
  height: 100%;
  border-radius: 3px;
  transition: width 1.2s cubic-bezier(0.22, 1, 0.36, 1);
}

.score-fill.blue { background: var(--accent-blue); }
.score-fill.cyan { background: var(--accent-cyan); }
.score-fill.green { background: var(--accent-green); }
.score-fill.amber { background: var(--accent-amber); }
.score-fill.purple { background: var(--accent-purple); }

.score-value {
  font-family: var(--font-mono);
  font-size: 10px;
  color: var(--text-secondary);
  width: 24px;
  text-align: right;
}

/* --- Version Card (Figma AI style) --- */
.card-version {
  padding: 10px 12px;
  border-radius: 10px;
  background: var(--bg-hover);
  border: 1px solid var(--accent-green);
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.version-info {
  display: flex;
  align-items: center;
  gap: 8px;
}

.version-name {
  font-size: 12px;
  font-weight: 500;
  color: var(--accent-blue);
}

.version-label {
  font-size: 10.5px;
  color: var(--text-tertiary);
}

.version-dot {
  width: 8px; height: 8px;
  border-radius: 50%;
  background: var(--accent-green);
}

/* Follow-up suggestions */
.suggestions {
  display: flex;
  flex-wrap: wrap;
  gap: 5px;
}

.suggestion-chip {
  padding: 5px 10px;
  border-radius: 7px;
  background: var(--bg-base);
  border: 1px solid var(--border-subtle);
  font-size: 11px;
  color: var(--text-tertiary);
  cursor: pointer;
  transition: all 0.15s;
  font-family: inherit;
}

.suggestion-chip:hover {
  border-color: var(--accent-blue);
  color: var(--accent-blue);
  background: var(--accent-blue-dim);
}

/* Tool activity label inline */
.tool-activity {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 6px 0;
}

.tool-activity-icon {
  width: 18px; height: 18px;
  border-radius: 5px;
  display: flex; align-items: center; justify-content: center;
}

.tool-activity-icon svg { width: 10px; height: 10px; }

.tool-activity-label {
  font-size: 11px;
  color: var(--text-tertiary);
  font-style: italic;
}

.tool-activity .spinner {
  width: 12px; height: 12px;
  border: 1.5px solid var(--border-default);
  border-top-color: var(--accent-blue);
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
}

@keyframes spin { to { transform: rotate(360deg); } }

/* ═══════════════════════════════════════════════
   INPUT AREA — Bottom anchored, Figma AI style
   ═══════════════════════════════════════════════ */

.input-area {
  padding: 12px 14px 14px;
  border-top: 1px solid var(--border-subtle);
  background: var(--bg-chat);
}

.input-container {
  border: 1px solid var(--border-default);
  border-radius: 12px;
  background: var(--bg-input);
  overflow: hidden;
  transition: border-color 0.2s, box-shadow 0.2s;
}

.input-container:focus-within {
  border-color: var(--border-focus);
  box-shadow: var(--shadow-glow);
}

.input-textarea {
  width: 100%;
  padding: 10px 12px 4px;
  background: transparent;
  border: none;
  outline: none;
  resize: none;
  font-family: var(--font-sans);
  font-size: 13px;
  line-height: 1.5;
  color: var(--text-primary);
  min-height: 20px;
  max-height: 100px;
}

.input-textarea::placeholder { color: var(--text-quaternary); }

.input-toolbar {
  padding: 6px 10px 8px;
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.input-toolbar-left {
  display: flex;
  align-items: center;
  gap: 4px;
}

.input-toolbar-right {
  display: flex;
  align-items: center;
  gap: 6px;
}

.toolbar-btn {
  width: 28px; height: 28px;
  border-radius: 6px;
  display: flex; align-items: center; justify-content: center;
  background: transparent;
  border: none;
  cursor: pointer;
  color: var(--text-tertiary);
  transition: all 0.15s;
}

.toolbar-btn:hover { background: var(--bg-hover); color: var(--text-secondary); }

.toolbar-btn svg { width: 15px; height: 15px; }

.model-selector {
  display: flex;
  align-items: center;
  gap: 4px;
  padding: 4px 8px;
  border-radius: 6px;
  font-size: 10.5px;
  color: var(--text-tertiary);
  cursor: pointer;
  background: transparent;
  border: none;
  font-family: var(--font-mono);
  transition: all 0.15s;
}

.model-selector:hover { background: var(--bg-hover); color: var(--text-secondary); }

.model-selector svg { width: 10px; height: 10px; }

.btn-send {
  width: 28px; height: 28px;
  border-radius: 7px;
  display: flex; align-items: center; justify-content: center;
  background: var(--accent-blue);
  border: none;
  cursor: pointer;
  transition: all 0.15s;
}

.btn-send:hover { background: #5a79ff; transform: scale(1.05); }

.btn-send svg { width: 14px; height: 14px; color: white; fill: white; }

.stop-btn {
  width: 28px; height: 28px;
  border-radius: 7px;
  display: flex; align-items: center; justify-content: center;
  background: var(--bg-hover);
  border: 1px solid var(--border-default);
  cursor: pointer;
  transition: all 0.15s;
}

.stop-btn:hover { border-color: var(--border-hover); }

.stop-btn .stop-icon {
  width: 10px; height: 10px;
  border-radius: 2px;
  background: var(--text-secondary);
}

/* ═══════════════════════════════════════════════
   SLASH COMMAND PALETTE
   ═══════════════════════════════════════════════ */

.slash-palette {
  position: absolute;
  bottom: 80px;
  left: 14px;
  right: 14px;
  background: var(--bg-elevated);
  border: 1px solid var(--border-default);
  border-radius: 11px;
  box-shadow: var(--shadow-md);
  overflow: hidden;
  z-index: 50;
  display: none;
}

.slash-palette.visible { display: block; animation: fadeUp 0.12s ease; }

@keyframes fadeUp {
  from { opacity: 0; transform: translateY(6px); }
  to { opacity: 1; transform: translateY(0); }
}

.slash-palette-header {
  padding: 8px 12px;
  font-size: 10px;
  font-weight: 500;
  color: var(--text-quaternary);
  text-transform: uppercase;
  letter-spacing: 0.06em;
  border-bottom: 1px solid var(--border-subtle);
}

.slash-item {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 8px 12px;
  cursor: pointer;
  transition: background 0.1s;
}

.slash-item:hover, .slash-item.selected { background: var(--bg-hover); }

.slash-icon {
  width: 26px; height: 26px;
  border-radius: 6px;
  display: flex; align-items: center; justify-content: center;
}

.slash-icon.blue { background: var(--accent-blue-dim); color: var(--accent-blue); }
.slash-icon.amber { background: var(--accent-amber-dim); color: var(--accent-amber); }
.slash-icon.purple { background: var(--accent-purple-dim); color: var(--accent-purple); }
.slash-icon.cyan { background: var(--accent-cyan-dim); color: var(--accent-cyan); }
.slash-icon.green { background: var(--accent-green-dim); color: var(--accent-green); }

.slash-icon svg { width: 13px; height: 13px; }

.slash-name {
  font-family: var(--font-mono);
  font-size: 12px;
  font-weight: 500;
  color: var(--text-primary);
}

.slash-desc {
  font-size: 11px;
  color: var(--text-tertiary);
  margin-top: 1px;
}

/* ═══════════════════════════════════════════════
   BLUEPRINT PANEL — Full remaining width
   ═══════════════════════════════════════════════ */

.blueprint-panel {
  flex: 1;
  display: flex;
  flex-direction: column;
  min-width: 0;
  background: var(--bg-base);
}

.blueprint-toolbar {
  height: 44px;
  padding: 0 20px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  border-bottom: 1px solid var(--border-subtle);
  flex-shrink: 0;
  background: var(--bg-elevated);
}

.blueprint-tabs {
  display: flex;
  align-items: center;
  gap: 2px;
}

.bp-tab {
  padding: 5px 12px;
  border-radius: 6px;
  font-size: 11.5px;
  font-weight: 500;
  color: var(--text-tertiary);
  cursor: pointer;
  border: none;
  background: none;
  font-family: inherit;
  transition: all 0.15s;
}

.bp-tab:hover { color: var(--text-secondary); }
.bp-tab.active { color: var(--text-primary); background: var(--bg-hover); }

.blueprint-actions {
  display: flex;
  align-items: center;
  gap: 6px;
}

.bp-action-btn {
  width: 30px; height: 30px;
  border-radius: 6px;
  display: flex; align-items: center; justify-content: center;
  background: transparent;
  border: 1px solid var(--border-subtle);
  cursor: pointer;
  color: var(--text-tertiary);
  transition: all 0.15s;
}

.bp-action-btn:hover { border-color: var(--border-hover); color: var(--text-secondary); }
.bp-action-btn svg { width: 14px; height: 14px; }

/* Blueprint content area */
.blueprint-content {
  flex: 1;
  overflow-y: auto;
  padding: 40px;
  display: flex;
  justify-content: center;
  scrollbar-width: thin;
  scrollbar-color: var(--border-default) transparent;
}

.blueprint-content::-webkit-scrollbar { width: 6px; }
.blueprint-content::-webkit-scrollbar-track { background: transparent; }
.blueprint-content::-webkit-scrollbar-thumb { background: var(--border-default); border-radius: 3px; }

.blueprint-doc {
  width: 100%;
  max-width: 880px;
}

/* Section navigation sidebar within blueprint */
.blueprint-section-nav {
  position: fixed;
  right: 24px;
  top: 50%;
  transform: translateY(-50%);
  display: flex;
  flex-direction: column;
  gap: 3px;
  z-index: 10;
}

.section-dot {
  width: 6px; height: 6px;
  border-radius: 50%;
  background: var(--text-quaternary);
  cursor: pointer;
  transition: all 0.2s;
}

.section-dot:hover { background: var(--text-tertiary); transform: scale(1.3); }
.section-dot.active { background: var(--accent-blue); transform: scale(1.5); }

/* Document content styles */
.doc-header {
  margin-bottom: 48px;
  padding-bottom: 32px;
  border-bottom: 1px solid var(--border-subtle);
}

.doc-title {
  font-family: var(--font-display);
  font-size: 32px;
  font-weight: 700;
  letter-spacing: -0.03em;
  color: var(--text-primary);
  line-height: 1.2;
  margin-bottom: 8px;
}

.doc-subtitle {
  font-size: 15px;
  color: var(--text-tertiary);
  line-height: 1.5;
}

.doc-meta {
  display: flex;
  gap: 20px;
  margin-top: 16px;
}

.doc-meta-item {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 12px;
  color: var(--text-tertiary);
}

.doc-meta-item svg { width: 13px; height: 13px; opacity: 0.6; }

.doc-section {
  margin-bottom: 40px;
}

.doc-section-title {
  font-family: var(--font-display);
  font-size: 20px;
  font-weight: 600;
  color: var(--text-primary);
  letter-spacing: -0.02em;
  margin-bottom: 16px;
  display: flex;
  align-items: center;
  gap: 8px;
}

.doc-section-badge {
  font-family: var(--font-mono);
  font-size: 9.5px;
  padding: 2px 6px;
  border-radius: 4px;
  background: var(--accent-blue-dim);
  color: var(--accent-blue);
  font-weight: 500;
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.doc-section-badge.ai { background: var(--accent-cyan-dim); color: var(--accent-cyan); }

.doc-text {
  font-size: 14px;
  line-height: 1.75;
  color: var(--text-secondary);
}

.doc-text strong { color: var(--text-primary); }

/* Stats grid within blueprint */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 12px;
  margin-top: 16px;
}

.stat-card {
  padding: 14px;
  border-radius: 10px;
  background: var(--bg-elevated);
  border: 1px solid var(--border-subtle);
}

.stat-value {
  font-family: var(--font-mono);
  font-size: 22px;
  font-weight: 500;
  color: var(--text-primary);
  margin-bottom: 4px;
}

.stat-label {
  font-size: 11.5px;
  color: var(--text-tertiary);
}

.stat-trend {
  font-size: 10.5px;
  margin-top: 6px;
  display: flex;
  align-items: center;
  gap: 3px;
}

.stat-trend.up { color: var(--accent-green); }
.stat-trend.down { color: var(--accent-red); }

/* Competitor cards */
.competitor-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 12px;
  margin-top: 16px;
}

.competitor-card {
  padding: 14px;
  border-radius: 10px;
  background: var(--bg-elevated);
  border: 1px solid var(--border-subtle);
  transition: border-color 0.15s;
}

.competitor-card:hover { border-color: var(--border-hover); }

.competitor-name {
  font-size: 14px;
  font-weight: 600;
  color: var(--text-primary);
  margin-bottom: 6px;
}

.competitor-detail {
  font-size: 12px;
  color: var(--text-tertiary);
  line-height: 1.5;
}

/* Highlight bar for AI-edited sections */
.ai-highlight {
  position: relative;
  padding-left: 14px;
  border-left: 2px solid var(--accent-cyan);
}

.ai-highlight::before {
  content: 'AI enhanced';
  position: absolute;
  top: -8px;
  left: 14px;
  font-family: var(--font-mono);
  font-size: 9px;
  text-transform: uppercase;
  letter-spacing: 0.06em;
  color: var(--accent-cyan);
  background: var(--bg-base);
  padding: 0 4px;
}

/* Streaming cursor */
.streaming-cursor {
  display: inline-block;
  width: 2px;
  height: 14px;
  background: var(--accent-blue);
  margin-left: 2px;
  vertical-align: text-bottom;
  animation: blink 0.8s step-end infinite;
}

@keyframes blink {
  0%, 100% { opacity: 1; }
  50% { opacity: 0; }
}

/* ═══════════════════════════════════════════════
   ANIMATIONS
   ═══════════════════════════════════════════════ */

.fade-in {
  animation: fadeIn 0.4s ease;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

.scale-in {
  animation: scaleIn 0.3s ease;
}

@keyframes scaleIn {
  from { opacity: 0; transform: scale(0.96); }
  to { opacity: 1; transform: scale(1); }
}

/* Score bar fill animation */
.animate-fill .score-fill {
  animation: fillBar 1.2s cubic-bezier(0.22, 1, 0.36, 1) forwards;
}

@keyframes fillBar {
  from { width: 0 !important; }
}
</style>
</head>
<body>

<div class="app">

  <!-- ═══ HEADER ═══ -->
  <header class="header">
    <div class="header-left">
      <div class="logo-mark">
        <svg viewBox="0 0 24 24"><path d="M13 3L4 14h7l-2 7 9-11h-7l2-7z"/></svg>
      </div>
      <div class="logo-text">Egoos <span>Strategic Blueprint</span></div>
    </div>

    <nav class="header-nav">
      <button class="nav-item">Onboarding</button>
      <button class="nav-item active">Review & Refine</button>
      <button class="nav-item">Export</button>
    </nav>

    <div class="header-actions">
      <button class="btn-header">Share</button>
      <button class="btn-header primary">Export PDF</button>
    </div>
  </header>

  <div class="main">

    <!-- ═══ CHAT PANEL (340px) ═══ -->
    <aside class="chat-panel">

      <div class="messages" id="messages">

        <!-- User message -->
        <div class="msg-user fade-in">
          <div class="msg-user-bubble">Research our top 3 competitors in the enterprise SaaS space and compare their positioning</div>
        </div>

        <!-- Reasoning / Thinking -->
        <div class="reasoning-block fade-in">
          <div class="reasoning-header">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><circle cx="12" cy="12" r="10"/><path d="M12 16v-4M12 8h.01"/></svg>
            Reasoning
          </div>
          <div class="reasoning-body">
            I'll research the enterprise SaaS competitive landscape, focusing on positioning, messaging, and key differentiators across the top players.
          </div>
        </div>

        <!-- Worked with files badge -->
        <div class="files-badge fade-in">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><path d="M14 2v6h6"/></svg>
          Worked with 4 files
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:10px;height:10px"><path d="M6 9l6 6 6-6"/></svg>
        </div>

        <!-- AI text response -->
        <div class="msg-ai fade-in">
          <div class="msg-ai-text">
            I've identified your top 3 competitors. Let me run deep research on each one to compare their positioning strategies.
          </div>
        </div>

        <!-- Tool activity -->
        <div class="tool-activity fade-in">
          <div class="tool-activity-icon" style="background:var(--accent-blue-dim);">
            <svg viewBox="0 0 24 24" fill="none" stroke="var(--accent-blue)" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="M21 21l-4.35-4.35"/></svg>
          </div>
          <span class="tool-activity-label">Searching competitor data…</span>
          <div class="spinner"></div>
        </div>

        <!-- Deep Research Card -->
        <div class="card-research scale-in">
          <div class="card-research-header">
            <span class="card-label blue">Deep Research</span>
            <span class="card-meta">6 sources · 8.2s</span>
          </div>
          <div class="card-research-steps">
            <div class="step-dot done">✓</div>
            <span class="step-label done">Decompose</span>
            <span class="step-arrow">→</span>
            <div class="step-dot done">✓</div>
            <span class="step-label done">Research</span>
            <span class="step-arrow">→</span>
            <div class="step-dot active"></div>
            <span class="step-label active">Synthesize</span>
          </div>
          <div class="card-research-body">
            <div class="finding">
              <div class="finding-title">HubSpot positioning</div>
              All-in-one platform messaging targeting mid-market growth teams<span class="citation">1</span>
            </div>
            <div class="finding">
              <div class="finding-title">Salesforce positioning</div>
              Enterprise CRM leader with AI-first "Einstein" narrative<span class="citation">2</span>
            </div>
            <div class="finding">
              <div class="finding-title">Pipedrive positioning</div>
              Sales-focused simplicity for SMBs, anti-complexity angle<span class="citation">3</span>
            </div>
          </div>
          <div class="card-research-sources">
            <div class="source-chip">
              <img src="https://www.google.com/s2/favicons?domain=hubspot.com&sz=32" alt="">hubspot.com
            </div>
            <div class="source-chip">
              <img src="https://www.google.com/s2/favicons?domain=salesforce.com&sz=32" alt="">salesforce.com
            </div>
            <div class="source-chip">
              <img src="https://www.google.com/s2/favicons?domain=g2.com&sz=32" alt="">g2.com
            </div>
          </div>
        </div>

        <!-- AI response after research -->
        <div class="msg-ai fade-in">
          <div class="msg-ai-text">
            Based on the research, here's a key insight: <strong>HubSpot owns the mid-market "all-in-one" narrative</strong> while <strong>Salesforce dominates enterprise with AI positioning</strong>. Your strongest opportunity is the gap between these — enterprise-grade capability with mid-market simplicity. I'd suggest updating the Competitive Landscape section.
          </div>
        </div>

        <!-- Edit Proposal Card -->
        <div class="card-edit scale-in">
          <div class="card-edit-header">
            <span class="card-label amber">Edit Proposal</span>
            <span class="card-edit-section">competitive-landscape.positioning</span>
          </div>
          <div class="card-edit-diff">
            <span class="diff-remove">Generic enterprise marketing platform</span><br>
            <span class="diff-add">AI-powered enterprise growth platform that combines Salesforce's depth with HubSpot's simplicity — purpose-built for modern revenue teams</span>
          </div>
          <div class="card-edit-actions">
            <span class="hint">Press <kbd>Y</kbd> approve <kbd>N</kbd> reject</span>
            <div class="btns">
              <button class="btn-reject">Reject</button>
              <button class="btn-approve">Approve</button>
            </div>
          </div>
        </div>

        <!-- Score Card -->
        <div class="card-score scale-in animate-fill">
          <div class="card-score-header">
            <span class="card-label cyan">Section Analysis</span>
            <span class="score-big">8.4</span>
          </div>
          <div class="card-score-bars">
            <div class="score-row">
              <span class="score-label">Clarity</span>
              <div class="score-track"><div class="score-fill blue" style="width:90%"></div></div>
              <span class="score-value">9.0</span>
            </div>
            <div class="score-row">
              <span class="score-label">Specificity</span>
              <div class="score-track"><div class="score-fill cyan" style="width:82%"></div></div>
              <span class="score-value">8.2</span>
            </div>
            <div class="score-row">
              <span class="score-label">Differentiation</span>
              <div class="score-track"><div class="score-fill green" style="width:78%"></div></div>
              <span class="score-value">7.8</span>
            </div>
            <div class="score-row">
              <span class="score-label">Actionability</span>
              <div class="score-track"><div class="score-fill amber" style="width:86%"></div></div>
              <span class="score-value">8.6</span>
            </div>
          </div>
        </div>

        <!-- Follow-up suggestions -->
        <div class="suggestions fade-in">
          <button class="suggestion-chip">Go deeper on HubSpot</button>
          <button class="suggestion-chip">Generate ad angles</button>
          <button class="suggestion-chip">Score all sections</button>
        </div>

        <!-- Version card like Figma AI -->
        <div class="card-version fade-in">
          <div class="version-info">
            <span class="version-name">Blueprint v3</span>
            <span class="version-label">Competitive section updated</span>
          </div>
          <div class="version-dot"></div>
        </div>

      </div>

      <!-- Slash Command Palette (hidden by default) -->
      <div class="slash-palette" id="slashPalette">
        <div class="slash-palette-header">Commands</div>
        <div class="slash-item selected">
          <div class="slash-icon blue">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="M21 21l-4.35-4.35"/></svg>
          </div>
          <div>
            <div class="slash-name">/research</div>
            <div class="slash-desc">Deep multi-step web research with citations</div>
          </div>
        </div>
        <div class="slash-item">
          <div class="slash-icon amber">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M11 4H4v14a2 2 0 002 2h12a2 2 0 002-2v-7"/><path d="M18.5 2.5a2.12 2.12 0 013 3L12 15l-4 1 1-4z"/></svg>
          </div>
          <div>
            <div class="slash-name">/edit</div>
            <div class="slash-desc">Propose changes to a blueprint section</div>
          </div>
        </div>
        <div class="slash-item">
          <div class="slash-icon purple">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/></svg>
          </div>
          <div>
            <div class="slash-name">/compare</div>
            <div class="slash-desc">Side-by-side competitor comparison table</div>
          </div>
        </div>
        <div class="slash-item">
          <div class="slash-icon cyan">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 20V10M12 20V4M6 20v-6"/></svg>
          </div>
          <div>
            <div class="slash-name">/analyze</div>
            <div class="slash-desc">Score and evaluate any section with evidence</div>
          </div>
        </div>
        <div class="slash-item">
          <div class="slash-icon green">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/><path d="M3 9h18M9 21V9"/></svg>
          </div>
          <div>
            <div class="slash-name">/visualize</div>
            <div class="slash-desc">Generate charts and data visualizations</div>
          </div>
        </div>
      </div>

      <!-- Input area -->
      <div class="input-area">
        <div class="input-container" id="inputContainer">
          <textarea class="input-textarea" id="chatInput" rows="1" placeholder="Ask about your blueprint..."></textarea>
          <div class="input-toolbar">
            <div class="input-toolbar-left">
              <button class="toolbar-btn" title="Attach file">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21.44 11.05l-9.19 9.19a6 6 0 01-8.49-8.49l9.19-9.19a4 4 0 015.66 5.66l-9.2 9.19a2 2 0 01-2.83-2.83l8.49-8.48"/></svg>
              </button>
              <button class="model-selector">
                Groq 70B
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 9l6 6 6-6"/></svg>
              </button>
            </div>
            <div class="input-toolbar-right">
              <button class="stop-btn" title="Stop generation" style="display:none">
                <div class="stop-icon"></div>
              </button>
              <button class="btn-send" title="Send message">
                <svg viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round"><path d="M22 2L11 13"/><path d="M22 2l-7 20-4-9-9-4z"/></svg>
              </button>
            </div>
          </div>
        </div>
      </div>

    </aside>

    <!-- ═══ BLUEPRINT PANEL (flex-1) ═══ -->
    <main class="blueprint-panel">

      <div class="blueprint-toolbar">
        <div class="blueprint-tabs">
          <button class="bp-tab active">Document</button>
          <button class="bp-tab">Outline</button>
          <button class="bp-tab">History</button>
        </div>
        <div class="blueprint-actions">
          <button class="bp-action-btn" title="Zoom">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="M21 21l-4.35-4.35"/><path d="M11 8v6M8 11h6"/></svg>
          </button>
          <button class="bp-action-btn" title="Print">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 9V2h12v7M6 18H4a2 2 0 01-2-2v-5a2 2 0 012-2h16a2 2 0 012 2v5a2 2 0 01-2 2h-2"/><rect x="6" y="14" width="12" height="8"/></svg>
          </button>
          <button class="bp-action-btn" title="Fullscreen">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M8 3H5a2 2 0 00-2 2v3m18 0V5a2 2 0 00-2-2h-3m0 18h3a2 2 0 002-2v-3M3 16v3a2 2 0 002 2h3"/></svg>
          </button>
        </div>
      </div>

      <div class="blueprint-content">
        <div class="blueprint-doc">

          <!-- Document Header -->
          <div class="doc-header">
            <h1 class="doc-title">Strategic Marketing Blueprint</h1>
            <p class="doc-subtitle">Paid media strategy for enterprise SaaS market entry — AI-generated competitive analysis with human refinement</p>
            <div class="doc-meta">
              <div class="doc-meta-item">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="18" rx="2"/><path d="M16 2v4M8 2v4M3 10h18"/></svg>
                Feb 26, 2026
              </div>
              <div class="doc-meta-item">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
                Version 3
              </div>
              <div class="doc-meta-item">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
                Ammar · Egoos Agent
              </div>
            </div>
          </div>

          <!-- Industry & Market Overview -->
          <div class="doc-section">
            <h2 class="doc-section-title">
              Industry & Market Overview
              <span class="doc-section-badge">Research</span>
            </h2>
            <p class="doc-text">
              The enterprise SaaS marketing technology space has reached <strong>$72.4B in global market size</strong> as of 2025, driven by increasing demand for AI-powered automation and personalization. The market is projected to grow at a <strong>14.2% CAGR through 2030</strong>, with particular acceleration in AI-augmented campaign management and predictive analytics segments.
            </p>
            <p class="doc-text" style="margin-top: 12px;">
              Key market dynamics include the consolidation of point solutions into integrated platforms, the rise of first-party data strategies in response to cookie deprecation, and growing demand for <strong>ROI attribution across complex B2B buying journeys</strong>.
            </p>

            <div class="stats-grid">
              <div class="stat-card">
                <div class="stat-value">$72.4B</div>
                <div class="stat-label">Market Size (2025)</div>
                <div class="stat-trend up">↑ 14.2% CAGR</div>
              </div>
              <div class="stat-card">
                <div class="stat-value">2,400+</div>
                <div class="stat-label">MarTech Vendors</div>
                <div class="stat-trend down">↓ 8% YoY (consolidation)</div>
              </div>
              <div class="stat-card">
                <div class="stat-value">67%</div>
                <div class="stat-label">AI Adoption Rate</div>
                <div class="stat-trend up">↑ 23% YoY</div>
              </div>
            </div>
          </div>

          <!-- Competitive Landscape -->
          <div class="doc-section">
            <h2 class="doc-section-title">
              Competitive Landscape
              <span class="doc-section-badge ai">AI Enhanced</span>
            </h2>

            <div class="ai-highlight">
              <p class="doc-text">
                <strong>Your positioning opportunity:</strong> AI-powered enterprise growth platform that combines Salesforce's depth with HubSpot's simplicity — purpose-built for modern revenue teams. This positions you in the strategic white space between complex enterprise tools and user-friendly mid-market platforms.
              </p>
            </div>

            <div class="competitor-grid">
              <div class="competitor-card">
                <div class="competitor-name">HubSpot</div>
                <div class="competitor-detail">
                  All-in-one platform for mid-market growth teams. Strong inbound methodology narrative. Weakness: perceived as lacking enterprise depth.
                </div>
              </div>
              <div class="competitor-card">
                <div class="competitor-name">Salesforce Marketing Cloud</div>
                <div class="competitor-detail">
                  Enterprise CRM leader with "Einstein AI" narrative. Deep integrations. Weakness: complexity, long implementation cycles.
                </div>
              </div>
              <div class="competitor-card">
                <div class="competitor-name">Pipedrive</div>
                <div class="competitor-detail">
                  Sales-focused simplicity for SMBs. Anti-complexity positioning. Weakness: limited marketing capabilities, small-deal focus.
                </div>
              </div>
              <div class="competitor-card">
                <div class="competitor-name">ActiveCampaign</div>
                <div class="competitor-detail">
                  Automation-first for growing businesses. Email + CRM bundle. Weakness: enterprise feature gaps, limited analytics depth.
                </div>
              </div>
            </div>
          </div>

          <!-- ICP Section -->
          <div class="doc-section">
            <h2 class="doc-section-title">
              Ideal Customer Profile
              <span class="doc-section-badge">Research</span>
            </h2>
            <p class="doc-text">
              <strong>Primary ICP: VP/Director of Growth Marketing</strong> at B2B SaaS companies ($10M–$100M ARR) with 50–500 employees. They manage 3–5 person marketing teams, own a $200K–$1M annual paid media budget, and are evaluated on pipeline generation and CAC efficiency. They've outgrown HubSpot but can't justify Salesforce complexity.
            </p>
            <p class="doc-text" style="margin-top: 12px;">
              <strong>Secondary ICP: Head of Demand Generation</strong> at high-growth startups (Series B–D) building their first scalable demand engine. Budget-conscious but velocity-driven, they need fast time-to-value and strong attribution.
            </p>
          </div>

        </div>
      </div>

      <!-- Section nav dots -->
      <div class="blueprint-section-nav">
        <div class="section-dot active" title="Industry & Market"></div>
        <div class="section-dot" title="Competitive Landscape"></div>
        <div class="section-dot" title="ICP"></div>
        <div class="section-dot" title="Offer Analysis"></div>
        <div class="section-dot" title="Channel Strategy"></div>
        <div class="section-dot" title="Budget Allocation"></div>
        <div class="section-dot" title="Creative Strategy"></div>
        <div class="section-dot" title="Measurement"></div>
      </div>
    </main>

  </div>
</div>

<!-- ═══════════════════════════════════════════════
   JAVASCRIPT — Interactions
   ═══════════════════════════════════════════════ -->
<script>
const chatInput = document.getElementById('chatInput');
const slashPalette = document.getElementById('slashPalette');

// Auto-resize textarea
chatInput.addEventListener('input', function() {
  this.style.height = 'auto';
  this.style.height = Math.min(this.scrollHeight, 100) + 'px';

  // Show/hide slash palette
  if (this.value === '/') {
    slashPalette.classList.add('visible');
  } else {
    slashPalette.classList.remove('visible');
  }
});

// Slash command selection
document.querySelectorAll('.slash-item').forEach(item => {
  item.addEventListener('click', function() {
    const cmd = this.querySelector('.slash-name').textContent;
    chatInput.value = cmd + ' ';
    chatInput.focus();
    slashPalette.classList.remove('visible');
  });
});

// Keyboard navigation in slash palette
let selectedIndex = 0;
const slashItems = document.querySelectorAll('.slash-item');

chatInput.addEventListener('keydown', function(e) {
  if (!slashPalette.classList.contains('visible')) return;

  if (e.key === 'ArrowDown') {
    e.preventDefault();
    slashItems[selectedIndex].classList.remove('selected');
    selectedIndex = (selectedIndex + 1) % slashItems.length;
    slashItems[selectedIndex].classList.add('selected');
  } else if (e.key === 'ArrowUp') {
    e.preventDefault();
    slashItems[selectedIndex].classList.remove('selected');
    selectedIndex = (selectedIndex - 1 + slashItems.length) % slashItems.length;
    slashItems[selectedIndex].classList.add('selected');
  } else if (e.key === 'Enter') {
    e.preventDefault();
    slashItems[selectedIndex].click();
  } else if (e.key === 'Escape') {
    slashPalette.classList.remove('visible');
  }
});

// Close palette on click outside
document.addEventListener('click', function(e) {
  if (!e.target.closest('.slash-palette') && !e.target.closest('.input-textarea')) {
    slashPalette.classList.remove('visible');
  }
});

// Score bar animation on scroll into view
const observer = new IntersectionObserver((entries) => {
  entries.forEach(entry => {
    if (entry.isIntersecting) {
      entry.target.classList.add('animate-fill');
    }
  });
}, { threshold: 0.5 });

document.querySelectorAll('.card-score').forEach(card => {
  observer.observe(card);
});

// Section nav dots
document.querySelectorAll('.section-dot').forEach(dot => {
  dot.addEventListener('click', function() {
    document.querySelectorAll('.section-dot').forEach(d => d.classList.remove('active'));
    this.classList.add('active');
  });
});

// Scroll messages to bottom
const messages = document.getElementById('messages');
messages.scrollTop = messages.scrollHeight;

// Nav items
document.querySelectorAll('.nav-item').forEach(item => {
  item.addEventListener('click', function() {
    document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
    this.classList.add('active');
  });
});

// Blueprint tabs
document.querySelectorAll('.bp-tab').forEach(tab => {
  tab.addEventListener('click', function() {
    document.querySelectorAll('.bp-tab').forEach(t => t.classList.remove('active'));
    this.classList.add('active');
  });
});
</script>

</body>
</html>
